{"code":"!function(t){var e={};function r(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,\"a\",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p=\"\",r(r.s=27)}([function(t,e,r){\"use strict\";var n=r(3),a=r(9),i=Object.prototype.toString;function o(t){return\"[object Array]\"===i.call(t)}function s(t){return null!==t&&\"object\"==typeof t}function u(t){return\"[object Function]\"===i.call(t)}function c(t,e){if(null!=t)if(\"object\"!=typeof t&&(t=[t]),o(t))for(var r=0,n=t.length;r<n;r++)e.call(null,t[r],r,t);else for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.call(null,t[a],a,t)}t.exports={isArray:o,isArrayBuffer:function(t){return\"[object ArrayBuffer]\"===i.call(t)},isBuffer:a,isFormData:function(t){return\"undefined\"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return\"undefined\"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return\"string\"==typeof t},isNumber:function(t){return\"number\"==typeof t},isObject:s,isUndefined:function(t){return void 0===t},isDate:function(t){return\"[object Date]\"===i.call(t)},isFile:function(t){return\"[object File]\"===i.call(t)},isBlob:function(t){return\"[object Blob]\"===i.call(t)},isFunction:u,isStream:function(t){return s(t)&&u(t.pipe)},isURLSearchParams:function(t){return\"undefined\"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return(\"undefined\"==typeof navigator||\"ReactNative\"!==navigator.product)&&\"undefined\"!=typeof window&&\"undefined\"!=typeof document},forEach:c,merge:function t(){var e={};function r(r,n){\"object\"==typeof e[n]&&\"object\"==typeof r?e[n]=t(e[n],r):e[n]=r}for(var n=0,a=arguments.length;n<a;n++)c(arguments[n],r);return e},extend:function(t,e,r){return c(e,function(e,a){t[a]=r&&\"function\"==typeof e?n(e,r):e}),t},trim:function(t){return t.replace(/^\\s*/,\"\").replace(/\\s*$/,\"\")}}},function(t,e,r){\"use strict\";(function(e){var n=r(0),a=r(12),i={\"Content-Type\":\"application/x-www-form-urlencoded\"};function o(t,e){!n.isUndefined(t)&&n.isUndefined(t[\"Content-Type\"])&&(t[\"Content-Type\"]=e)}var s,u={adapter:(\"undefined\"!=typeof XMLHttpRequest?s=r(4):void 0!==e&&(s=r(4)),s),transformRequest:[function(t,e){return a(e,\"Content-Type\"),n.isFormData(t)||n.isArrayBuffer(t)||n.isBuffer(t)||n.isStream(t)||n.isFile(t)||n.isBlob(t)?t:n.isArrayBufferView(t)?t.buffer:n.isURLSearchParams(t)?(o(e,\"application/x-www-form-urlencoded;charset=utf-8\"),t.toString()):n.isObject(t)?(o(e,\"application/json;charset=utf-8\"),JSON.stringify(t)):t}],transformResponse:[function(t){if(\"string\"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:\"XSRF-TOKEN\",xsrfHeaderName:\"X-XSRF-TOKEN\",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300}};u.headers={common:{Accept:\"application/json, text/plain, */*\"}},n.forEach([\"delete\",\"get\",\"head\"],function(t){u.headers[t]={}}),n.forEach([\"post\",\"put\",\"patch\"],function(t){u.headers[t]=n.merge(i)}),t.exports=u}).call(this,r(11))},function(t,e,r){t.exports=r(8)},function(t,e,r){\"use strict\";t.exports=function(t,e){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return t.apply(e,r)}}},function(t,e,r){\"use strict\";var n=r(0),a=r(13),i=r(15),o=r(16),s=r(17),u=r(5),c=\"undefined\"!=typeof window&&window.btoa&&window.btoa.bind(window)||r(18);t.exports=function(t){return new Promise(function(e,l){var h=t.data,f=t.headers;n.isFormData(h)&&delete f[\"Content-Type\"];var d=new XMLHttpRequest,p=\"onreadystatechange\",m=!1;if(\"undefined\"==typeof window||!window.XDomainRequest||\"withCredentials\"in d||s(t.url)||(d=new window.XDomainRequest,p=\"onload\",m=!0,d.onprogress=function(){},d.ontimeout=function(){}),t.auth){var y=t.auth.username||\"\",g=t.auth.password||\"\";f.Authorization=\"Basic \"+c(y+\":\"+g)}if(d.open(t.method.toUpperCase(),i(t.url,t.params,t.paramsSerializer),!0),d.timeout=t.timeout,d[p]=function(){if(d&&(4===d.readyState||m)&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf(\"file:\"))){var r=\"getAllResponseHeaders\"in d?o(d.getAllResponseHeaders()):null,n={data:t.responseType&&\"text\"!==t.responseType?d.response:d.responseText,status:1223===d.status?204:d.status,statusText:1223===d.status?\"No Content\":d.statusText,headers:r,config:t,request:d};a(e,l,n),d=null}},d.onerror=function(){l(u(\"Network Error\",t,null,d)),d=null},d.ontimeout=function(){l(u(\"timeout of \"+t.timeout+\"ms exceeded\",t,\"ECONNABORTED\",d)),d=null},n.isStandardBrowserEnv()){var w=r(19),v=(t.withCredentials||s(t.url))&&t.xsrfCookieName?w.read(t.xsrfCookieName):void 0;v&&(f[t.xsrfHeaderName]=v)}if(\"setRequestHeader\"in d&&n.forEach(f,function(t,e){void 0===h&&\"content-type\"===e.toLowerCase()?delete f[e]:d.setRequestHeader(e,t)}),t.withCredentials&&(d.withCredentials=!0),t.responseType)try{d.responseType=t.responseType}catch(e){if(\"json\"!==t.responseType)throw e}\"function\"==typeof t.onDownloadProgress&&d.addEventListener(\"progress\",t.onDownloadProgress),\"function\"==typeof t.onUploadProgress&&d.upload&&d.upload.addEventListener(\"progress\",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(t){d&&(d.abort(),l(t),d=null)}),void 0===h&&(h=null),d.send(h)})}},function(t,e,r){\"use strict\";var n=r(14);t.exports=function(t,e,r,a,i){var o=new Error(t);return n(o,e,r,a,i)}},function(t,e,r){\"use strict\";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,r){\"use strict\";function n(t){this.message=t}n.prototype.toString=function(){return\"Cancel\"+(this.message?\": \"+this.message:\"\")},n.prototype.__CANCEL__=!0,t.exports=n},function(t,e,r){\"use strict\";var n=r(0),a=r(3),i=r(10),o=r(1);function s(t){var e=new i(t),r=a(i.prototype.request,e);return n.extend(r,i.prototype,e),n.extend(r,e),r}var u=s(o);u.Axios=i,u.create=function(t){return s(n.merge(o,t))},u.Cancel=r(7),u.CancelToken=r(25),u.isCancel=r(6),u.all=function(t){return Promise.all(t)},u.spread=r(26),t.exports=u,t.exports.default=u},function(t,e){function r(t){return!!t.constructor&&\"function\"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}\n/*!\n * Determine if an object is a Buffer\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\nt.exports=function(t){return null!=t&&(r(t)||function(t){return\"function\"==typeof t.readFloatLE&&\"function\"==typeof t.slice&&r(t.slice(0,0))}(t)||!!t._isBuffer)}},function(t,e,r){\"use strict\";var n=r(1),a=r(0),i=r(20),o=r(21);function s(t){this.defaults=t,this.interceptors={request:new i,response:new i}}s.prototype.request=function(t){\"string\"==typeof t&&(t=a.merge({url:arguments[0]},arguments[1])),(t=a.merge(n,{method:\"get\"},this.defaults,t)).method=t.method.toLowerCase();var e=[o,void 0],r=Promise.resolve(t);for(this.interceptors.request.forEach(function(t){e.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function(t){e.push(t.fulfilled,t.rejected)});e.length;)r=r.then(e.shift(),e.shift());return r},a.forEach([\"delete\",\"get\",\"head\",\"options\"],function(t){s.prototype[t]=function(e,r){return this.request(a.merge(r||{},{method:t,url:e}))}}),a.forEach([\"post\",\"put\",\"patch\"],function(t){s.prototype[t]=function(e,r,n){return this.request(a.merge(n||{},{method:t,url:e,data:r}))}}),t.exports=s},function(t,e){var r,n,a=t.exports={};function i(){throw new Error(\"setTimeout has not been defined\")}function o(){throw new Error(\"clearTimeout has not been defined\")}function s(t){if(r===setTimeout)return setTimeout(t,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r=\"function\"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{n=\"function\"==typeof clearTimeout?clearTimeout:o}catch(t){n=o}}();var u,c=[],l=!1,h=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):h=-1,c.length&&d())}function d(){if(!l){var t=s(f);l=!0;for(var e=c.length;e;){for(u=c,c=[];++h<e;)u&&u[h].run();h=-1,e=c.length}u=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}a.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new p(t,e)),1!==c.length||l||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},a.title=\"browser\",a.browser=!0,a.env={},a.argv=[],a.version=\"\",a.versions={},a.on=m,a.addListener=m,a.once=m,a.off=m,a.removeListener=m,a.removeAllListeners=m,a.emit=m,a.prependListener=m,a.prependOnceListener=m,a.listeners=function(t){return[]},a.binding=function(t){throw new Error(\"process.binding is not supported\")},a.cwd=function(){return\"/\"},a.chdir=function(t){throw new Error(\"process.chdir is not supported\")},a.umask=function(){return 0}},function(t,e,r){\"use strict\";var n=r(0);t.exports=function(t,e){n.forEach(t,function(r,n){n!==e&&n.toUpperCase()===e.toUpperCase()&&(t[e]=r,delete t[n])})}},function(t,e,r){\"use strict\";var n=r(5);t.exports=function(t,e,r){var a=r.config.validateStatus;r.status&&a&&!a(r.status)?e(n(\"Request failed with status code \"+r.status,r.config,null,r.request,r)):t(r)}},function(t,e,r){\"use strict\";t.exports=function(t,e,r,n,a){return t.config=e,r&&(t.code=r),t.request=n,t.response=a,t}},function(t,e,r){\"use strict\";var n=r(0);function a(t){return encodeURIComponent(t).replace(/%40/gi,\"@\").replace(/%3A/gi,\":\").replace(/%24/g,\"$\").replace(/%2C/gi,\",\").replace(/%20/g,\"+\").replace(/%5B/gi,\"[\").replace(/%5D/gi,\"]\")}t.exports=function(t,e,r){if(!e)return t;var i;if(r)i=r(e);else if(n.isURLSearchParams(e))i=e.toString();else{var o=[];n.forEach(e,function(t,e){null!=t&&(n.isArray(t)?e+=\"[]\":t=[t],n.forEach(t,function(t){n.isDate(t)?t=t.toISOString():n.isObject(t)&&(t=JSON.stringify(t)),o.push(a(e)+\"=\"+a(t))}))}),i=o.join(\"&\")}return i&&(t+=(-1===t.indexOf(\"?\")?\"?\":\"&\")+i),t}},function(t,e,r){\"use strict\";var n=r(0),a=[\"age\",\"authorization\",\"content-length\",\"content-type\",\"etag\",\"expires\",\"from\",\"host\",\"if-modified-since\",\"if-unmodified-since\",\"last-modified\",\"location\",\"max-forwards\",\"proxy-authorization\",\"referer\",\"retry-after\",\"user-agent\"];t.exports=function(t){var e,r,i,o={};return t?(n.forEach(t.split(\"\\n\"),function(t){if(i=t.indexOf(\":\"),e=n.trim(t.substr(0,i)).toLowerCase(),r=n.trim(t.substr(i+1)),e){if(o[e]&&a.indexOf(e)>=0)return;o[e]=\"set-cookie\"===e?(o[e]?o[e]:[]).concat([r]):o[e]?o[e]+\", \"+r:r}}),o):o}},function(t,e,r){\"use strict\";var n=r(0);t.exports=n.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement(\"a\");function a(t){var n=t;return e&&(r.setAttribute(\"href\",n),n=r.href),r.setAttribute(\"href\",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,\"\"):\"\",host:r.host,search:r.search?r.search.replace(/^\\?/,\"\"):\"\",hash:r.hash?r.hash.replace(/^#/,\"\"):\"\",hostname:r.hostname,port:r.port,pathname:\"/\"===r.pathname.charAt(0)?r.pathname:\"/\"+r.pathname}}return t=a(window.location.href),function(e){var r=n.isString(e)?a(e):e;return r.protocol===t.protocol&&r.host===t.host}}():function(){return!0}},function(t,e,r){\"use strict\";var n=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";function a(){this.message=\"String contains an invalid character\"}a.prototype=new Error,a.prototype.code=5,a.prototype.name=\"InvalidCharacterError\",t.exports=function(t){for(var e,r,i=String(t),o=\"\",s=0,u=n;i.charAt(0|s)||(u=\"=\",s%1);o+=u.charAt(63&e>>8-s%1*8)){if((r=i.charCodeAt(s+=.75))>255)throw new a;e=e<<8|r}return o}},function(t,e,r){\"use strict\";var n=r(0);t.exports=n.isStandardBrowserEnv()?{write:function(t,e,r,a,i,o){var s=[];s.push(t+\"=\"+encodeURIComponent(e)),n.isNumber(r)&&s.push(\"expires=\"+new Date(r).toGMTString()),n.isString(a)&&s.push(\"path=\"+a),n.isString(i)&&s.push(\"domain=\"+i),!0===o&&s.push(\"secure\"),document.cookie=s.join(\"; \")},read:function(t){var e=document.cookie.match(new RegExp(\"(^|;\\\\s*)(\"+t+\")=([^;]*)\"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,\"\",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,r){\"use strict\";var n=r(0);function a(){this.handlers=[]}a.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},a.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},a.prototype.forEach=function(t){n.forEach(this.handlers,function(e){null!==e&&t(e)})},t.exports=a},function(t,e,r){\"use strict\";var n=r(0),a=r(22),i=r(6),o=r(1),s=r(23),u=r(24);function c(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return c(t),t.baseURL&&!s(t.url)&&(t.url=u(t.baseURL,t.url)),t.headers=t.headers||{},t.data=a(t.data,t.headers,t.transformRequest),t.headers=n.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),n.forEach([\"delete\",\"get\",\"head\",\"post\",\"put\",\"patch\",\"common\"],function(e){delete t.headers[e]}),(t.adapter||o.adapter)(t).then(function(e){return c(t),e.data=a(e.data,e.headers,t.transformResponse),e},function(e){return i(e)||(c(t),e&&e.response&&(e.response.data=a(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},function(t,e,r){\"use strict\";var n=r(0);t.exports=function(t,e,r){return n.forEach(r,function(r){t=r(t,e)}),t}},function(t,e,r){\"use strict\";t.exports=function(t){return/^([a-z][a-z\\d\\+\\-\\.]*:)?\\/\\//i.test(t)}},function(t,e,r){\"use strict\";t.exports=function(t,e){return e?t.replace(/\\/+$/,\"\")+\"/\"+e.replace(/^\\/+/,\"\"):t}},function(t,e,r){\"use strict\";var n=r(7);function a(t){if(\"function\"!=typeof t)throw new TypeError(\"executor must be a function.\");var e;this.promise=new Promise(function(t){e=t});var r=this;t(function(t){r.reason||(r.reason=new n(t),e(r.reason))})}a.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},a.source=function(){var t;return{token:new a(function(e){t=e}),cancel:t}},t.exports=a},function(t,e,r){\"use strict\";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,r){\"use strict\";r.r(e);var n=r(2),a=r.n(n);let i,o=new Map,s=new Map;r.d(e,\"default\",function(){return N});let u=document.getElementById(\"game\"),c=u.getContext(\"2d\"),l=new class{constructor(){if(i)return i;i=this,this.reset(),this.prepared=0,this.aiOver=!0,this.playerOver=!0,this.initAIState(),this.randomAITarget(),this.initPlayerState(),this.randomPlayerTarget(),this.initPolicy(),this.initTransition()}initAIState(){this.aiState<0&&(this.aiState=parseInt(100*Math.random()),this.aiLastState=this.aiState)}initPlayerState(){this.playerState<0&&(this.playerState=parseInt(100*Math.random()),this.playerLastState=this.playerState)}initPolicy(){var t=this;a.a.get(\"https://eater.liwanyi.me/policy\").then(function(e){for(var r in e.data){var n=e.data[r],a=new Map;for(var i in n)a.set(parseInt(i),parseInt(n[i]));o.set(parseInt(r),a)}t.prepared+=1}).catch(function(t){console.log(t)})}initTransition(){var t=this;a.a.get(\"https://eater.liwanyi.me/transition\").then(function(e){for(var r in e.data){var n=e.data[r];s.set(parseInt(r),n)}t.prepared+=1}).catch(function(t){console.log(t)})}isPrepared(){return this.prepared>=2}reset(){this.frame=0,this.aiState=-1,this.aiLastState=-1,this.aiAction=-1,this.aiTarget=-1,this.playerState=-1,this.playerLastState=-1,this.playerAction=-1,this.playerTarget=-1,this.playerLastAction=this.playerAction,this.playerLastTouchTime=0,this.playerShouldStop=!1,this.playerPoint=0,this.aiPoint=0,this.gameOver=!1,this.rate=.5,this.lastRate=0}getPlayerPoint(){return this.playerPoint>9?this.playerPoint:\"0\"+this.playerPoint}getAIPoint(){return this.aiPoint>9?this.aiPoint:\"0\"+this.aiPoint}randomAITarget(){for(this.aiLastTarget=this.aiTarget;;){var t=parseInt(100*Math.random());if(t!=this.playerTarget&&t!=this.aiState&&t!=this.playerState){this.aiTarget=t;break}}}getPointRate(){return this.rate}calculateRate(){if(this.aiPoint>this.playerPoint){var t=this.aiPoint-this.playerPoint;this.rate=(50+t)/100}else this.aiPoint<this.playerPoint&&(t=this.playerPoint-this.aiPoint,this.rate=(50-t)/100)}shouldDrawPoint(){return this.lastRate!=this.rate}resetLastRate(){this.lastRate=this.rate}checkGameOver(){return(this.aiPoint>=50||this.playerPoint>=50)&&(this.gameOver=!0),this.gameOver=!1,this.gameOver}randomPlayerTarget(){for(this.playerLastTarget=this.playerTarget;;){var t=parseInt(100*Math.random());if(t!=this.aiTarget&&t!=this.playerState&&t!=this.aiState){this.playerTarget=t;break}}}nextAIState(){return this.aiAction=this.getAction(this.aiState,this.aiTarget),this.aiLastState=this.aiState,this.aiState=this.getState(this.aiState,this.aiAction),this.aiState}nextPlayerState(){return-1==this.playerAction?this.playerState:(this.playerLastState=this.playerState,this.playerState=this.getState(this.playerState,this.playerAction),this.playerState)}setPlayerAction(t){this.playerLastAction=this.playerAction,this.playerAction=t}isAIOver(){return this.aiOver=this.aiState==this.aiTarget,this.aiOver&&(this.aiPoint+=1,this.calculateRate()),this.aiOver}isPlayerOver(){return this.playerOver=this.playerState==this.playerTarget,this.playerOver&&(this.playerPoint+=1,this.calculateRate()),this.playerOver}getAction(t,e){return o.get(e).get(t)}getState(t,e){return s.get(t)[e]}},h=24,f=4,d=h+f,p=10*h+11*f,m=parseInt(window.innerHeight/4),y=(window.innerWidth-p)/2;console.log(y,m);let g=20,w=5;var v=document.createElement(\"canvas\"),T=v.getContext(\"2d\"),S=document.createElement(\"canvas\"),L=S.getContext(\"2d\"),A=parseInt(window.innerWidth/3),P=parseInt(window.innerHeight/24),b=A,I=parseInt(window.innerHeight/6),x=document.createElement(\"canvas\"),E=x.getContext(\"2d\"),R=document.getElementById(\"img_bean_ai\"),O=document.getElementById(\"img_bean_player\"),_=document.getElementById(\"img_eater_ai_up\"),B=document.getElementById(\"img_eater_ai_right\"),C=document.getElementById(\"img_eater_ai_down\"),j=document.getElementById(\"img_eater_ai_left\"),k=document.getElementById(\"img_eater_player_up\"),D=document.getElementById(\"img_eater_player_right\"),q=document.getElementById(\"img_eater_player_down\"),U=document.getElementById(\"img_eater_player_left\");class N{constructor(){this.aniId=0,console.log(\"constructor\"),this.initTouchEvent(),this.initLabyrinth(),this.start()}start(){u.removeEventListener(\"touchstart\",this.touchHandler),this.bindLoop=this.loop.bind(this),window.cancelAnimationFrame(this.aniId),this.aniId=window.requestAnimationFrame(this.bindLoop,u),console.log(\"start\")}initTouchEvent(){u.addEventListener(\"touchstart\",t=>{if(t.preventDefault(),0==l.playerLastTouchTime)l.playerLastTouchTime=(new Date).getTime();else{var e=(new Date).getTime();e-l.playerLastTouchTime<=250&&(l.playerShouldStop=!0),l.playerLastTouchTime=e}l.playerTouchStartX=t.touches[0].clientX,l.playerTouchStartY=t.touches[0].clientY}),u.addEventListener(\"touchmove\",t=>{t.preventDefault();var e=t.touches[0].clientX,r=t.touches[0].clientY-l.playerTouchStartY,n=e-l.playerTouchStartX;Math.abs(n)<50&&Math.abs(r)<50||(Math.abs(r)>Math.abs(n)?r>0?l.setPlayerAction(2):l.setPlayerAction(0):n>0?l.setPlayerAction(1):l.setPlayerAction(3))}),u.addEventListener(\"touchend\",t=>{t.preventDefault(),l.playerShouldStop&&(l.setPlayerAction(-1),l.playerShouldStop=!1)})}initLabyrinth(){c.lineWidth=f/2,this.setBackground(),this.drawBorder(),this.drawLabyrinth()}drawLine(t){var e=t[0],r=e[0]*d+y;10==e[0]&&(r+=f);var n=e[1]*d+m;10==e[1]&&(n+=f),T.moveTo(r,n);for(var a=1;a<t.length;a++){r=t[a][0]*d+y;10==t[a][0]&&(r+=f);n=t[a][1]*d+m;10==t[a][1]&&(n+=f),T.lineTo(r,n)}}drawLabyrinth(){this.drawLine([[5,0],[5,1],[4,1],[4,3]]),this.drawLine([[0,1],[2,1],[2,2],[3,2],[3,1]]),this.drawLine([[7,1],[10,1]]),this.drawLine([[6,1],[6,3]]),this.drawLine([[5,2],[9,2],[9,6]]),this.drawLine([[1,2],[1,3],[5,3]]),this.drawLine([[8,3],[7,3],[7,8]]),this.drawLine([[3,3],[3,5]]),this.drawLine([[3,4],[5,4]]),this.drawLine([[0,4],[2,4],[2,5],[1,5]]),this.drawLine([[8,4],[6,4],[6,5],[4,5],[4,7]]),this.drawLine([[9,5],[8,5],[8,7],[10,7]]),this.drawLine([[1,6],[4,6]]),this.drawLine([[2,6],[2,9]]),this.drawLine([[0,7],[1,7]]),this.drawLine([[1,8],[1,10]]),this.drawLine([[3,7],[3,10]]),this.drawLine([[3,8],[5,8],[5,6]]),this.drawLine([[4,9],[6,9],[6,8],[8,8],[8,9],[9,9],[9,8]]),this.drawLine([[5,9],[5,10]]),this.drawLine([[7,9],[7,10]]),T.stroke()}drawBorder(){T.strokeStyle=\"black\",T.strokeRect(y,m,p,p)}setBackground(){T.fillStyle=\"white\",T.fillRect(0,0,u.width,u.height)}touchEventHandler(t){t.preventDefault()}clearAITarget(){var t=l.aiTarget%10,e=parseInt(l.aiTarget/10),r=(t+1)*f+t*h+y,n=(e+1)*f+e*h+m;E.clearRect(r,n,20,20)}clearPlayerTarget(){var t=l.playerTarget%10,e=parseInt(l.playerTarget/10),r=(t+1)*f+t*h+y,n=(e+1)*f+e*h+m;E.clearRect(r,n,20,20)}drawAITarget(){var t=l.aiTarget,e=t%10,r=parseInt(t/10),n=(e+1)*f+e*h+y,a=(r+1)*f+r*h+m;E.drawImage(R,n,a),c.drawImage(x,0,0)}drawPlayerTarget(){var t=l.playerTarget,e=t%10,r=parseInt(t/10),n=(e+1)*f+e*h+y,a=(r+1)*f+r*h+m;E.drawImage(O,n,a),c.drawImage(x,0,0)}drawTarget(){l.aiLastTarget!=l.aiTarget&&this.clearAITarget(),this.drawAITarget(),l.playerLastTarget!=l.playerTarget&&this.clearPlayerTarget(),this.drawPlayerTarget()}drawAI(){var t=l.aiState,e=t%10,r=parseInt(t/10),n=(e+1)*f+e*h+y,a=(r+1)*f+r*h+m;0===l.aiAction?E.drawImage(_,n,a):1===l.aiAction?E.drawImage(B,n,a):2===l.aiAction?E.drawImage(C,n,a):E.drawImage(j,n,a),c.drawImage(x,0,0)}drawPlayer(){var t=-1;t=-1==l.playerAction?l.playerLastAction:l.playerAction;var e=l.playerState,r=e%10,n=parseInt(e/10),a=(r+1)*f+r*h+y,i=(n+1)*f+n*h+m;0===t?E.drawImage(k,a,i):1===t?E.drawImage(D,a,i):2===t?E.drawImage(q,a,i):E.drawImage(U,a,i),c.drawImage(x,0,0)}drawPoint(){if(l.shouldDrawPoint()){L.clearRect(0,0,S.width,S.height);var t=l.getPointRate(),e=b+A*(t-.05),r=b+A*(t+.05),n=L.createLinearGradient(e,0,r,0);n.addColorStop(0,\"red\"),n.addColorStop(1,\"blue\"),L.fillStyle=n,L.fillRect(b,I,A,P),l.resetLastRate()}c.drawImage(S,0,0)}clearAll(){c.clearRect(0,0,u.width,u.height),E.clearRect(0,0,x.width,x.height)}doRender(){this.clearAll(),c.drawImage(v,0,0),console.log(\"draw image\"),this.drawAI(),this.drawPlayer(),this.drawTarget(),this.drawPoint()}render(){this.doRender(),l.gameOver&&(this.hasEventBind||(this.hasEventBind=!0,this.touchHandler=this.touchEventHandler.bind(this),u.addEventListener(\"touchstart\",this.touchHandler)))}update(){l.checkGameOver(),l.gameOver||(l.nextAIState(),l.nextPlayerState(),l.isAIOver()&&l.randomAITarget(),l.isPlayerOver()&&l.randomPlayerTarget())}loop(){l.frame+=1,l.isPrepared()&&(l.frame%g==0&&this.update(),l.frame%w==0&&this.render()),this.aniId=window.requestAnimationFrame(this.bindLoop,u)}}new N}]);","extractedComments":[]}