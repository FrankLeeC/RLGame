!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=27)}([function(t,e,r){"use strict";var n=r(3),i=r(9),a=Object.prototype.toString;function o(t){return"[object Array]"===a.call(t)}function s(t){return null!==t&&"object"==typeof t}function c(t){return"[object Function]"===a.call(t)}function u(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),o(t))for(var r=0,n=t.length;r<n;r++)e.call(null,t[r],r,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}t.exports={isArray:o,isArrayBuffer:function(t){return"[object ArrayBuffer]"===a.call(t)},isBuffer:i,isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:s,isUndefined:function(t){return void 0===t},isDate:function(t){return"[object Date]"===a.call(t)},isFile:function(t){return"[object File]"===a.call(t)},isBlob:function(t){return"[object Blob]"===a.call(t)},isFunction:c,isStream:function(t){return s(t)&&c(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function t(){var e={};function r(r,n){"object"==typeof e[n]&&"object"==typeof r?e[n]=t(e[n],r):e[n]=r}for(var n=0,i=arguments.length;n<i;n++)u(arguments[n],r);return e},extend:function(t,e,r){return u(e,function(e,i){t[i]=r&&"function"==typeof e?n(e,r):e}),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(t,e,r){"use strict";(function(e){var n=r(0),i=r(12),a={"Content-Type":"application/x-www-form-urlencoded"};function o(t,e){!n.isUndefined(t)&&n.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var s,c={adapter:("undefined"!=typeof XMLHttpRequest?s=r(4):void 0!==e&&(s=r(4)),s),transformRequest:[function(t,e){return i(e,"Content-Type"),n.isFormData(t)||n.isArrayBuffer(t)||n.isBuffer(t)||n.isStream(t)||n.isFile(t)||n.isBlob(t)?t:n.isArrayBufferView(t)?t.buffer:n.isURLSearchParams(t)?(o(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):n.isObject(t)?(o(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},n.forEach(["delete","get","head"],function(t){c.headers[t]={}}),n.forEach(["post","put","patch"],function(t){c.headers[t]=n.merge(a)}),t.exports=c}).call(this,r(11))},function(t,e,r){t.exports=r(8)},function(t,e,r){"use strict";t.exports=function(t,e){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return t.apply(e,r)}}},function(t,e,r){"use strict";var n=r(0),i=r(13),a=r(15),o=r(16),s=r(17),c=r(5),u="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||r(18);t.exports=function(t){return new Promise(function(e,h){var l=t.data,f=t.headers;n.isFormData(l)&&delete f["Content-Type"];var d=new XMLHttpRequest,p="onreadystatechange",g=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in d||s(t.url)||(d=new window.XDomainRequest,p="onload",g=!0,d.onprogress=function(){},d.ontimeout=function(){}),t.auth){var m=t.auth.username||"",y=t.auth.password||"";f.Authorization="Basic "+u(m+":"+y)}if(d.open(t.method.toUpperCase(),a(t.url,t.params,t.paramsSerializer),!0),d.timeout=t.timeout,d[p]=function(){if(d&&(4===d.readyState||g)&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in d?o(d.getAllResponseHeaders()):null,n={data:t.responseType&&"text"!==t.responseType?d.response:d.responseText,status:1223===d.status?204:d.status,statusText:1223===d.status?"No Content":d.statusText,headers:r,config:t,request:d};i(e,h,n),d=null}},d.onerror=function(){h(c("Network Error",t,null,d)),d=null},d.ontimeout=function(){h(c("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",d)),d=null},n.isStandardBrowserEnv()){var w=r(19),v=(t.withCredentials||s(t.url))&&t.xsrfCookieName?w.read(t.xsrfCookieName):void 0;v&&(f[t.xsrfHeaderName]=v)}if("setRequestHeader"in d&&n.forEach(f,function(t,e){void 0===l&&"content-type"===e.toLowerCase()?delete f[e]:d.setRequestHeader(e,t)}),t.withCredentials&&(d.withCredentials=!0),t.responseType)try{d.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&d.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(t){d&&(d.abort(),h(t),d=null)}),void 0===l&&(l=null),d.send(l)})}},function(t,e,r){"use strict";var n=r(14);t.exports=function(t,e,r,i,a){var o=new Error(t);return n(o,e,r,i,a)}},function(t,e,r){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,r){"use strict";function n(t){this.message=t}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,t.exports=n},function(t,e,r){"use strict";var n=r(0),i=r(3),a=r(10),o=r(1);function s(t){var e=new a(t),r=i(a.prototype.request,e);return n.extend(r,a.prototype,e),n.extend(r,e),r}var c=s(o);c.Axios=a,c.create=function(t){return s(n.merge(o,t))},c.Cancel=r(7),c.CancelToken=r(25),c.isCancel=r(6),c.all=function(t){return Promise.all(t)},c.spread=r(26),t.exports=c,t.exports.default=c},function(t,e){function r(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&(r(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&r(t.slice(0,0))}(t)||!!t._isBuffer)}},function(t,e,r){"use strict";var n=r(1),i=r(0),a=r(20),o=r(21);function s(t){this.defaults=t,this.interceptors={request:new a,response:new a}}s.prototype.request=function(t){"string"==typeof t&&(t=i.merge({url:arguments[0]},arguments[1])),(t=i.merge(n,{method:"get"},this.defaults,t)).method=t.method.toLowerCase();var e=[o,void 0],r=Promise.resolve(t);for(this.interceptors.request.forEach(function(t){e.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function(t){e.push(t.fulfilled,t.rejected)});e.length;)r=r.then(e.shift(),e.shift());return r},i.forEach(["delete","get","head","options"],function(t){s.prototype[t]=function(e,r){return this.request(i.merge(r||{},{method:t,url:e}))}}),i.forEach(["post","put","patch"],function(t){s.prototype[t]=function(e,r,n){return this.request(i.merge(n||{},{method:t,url:e,data:r}))}}),t.exports=s},function(t,e){var r,n,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(t){r=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(t){n=o}}();var c,u=[],h=!1,l=-1;function f(){h&&c&&(h=!1,c.length?u=c.concat(u):l=-1,u.length&&d())}function d(){if(!h){var t=s(f);h=!0;for(var e=u.length;e;){for(c=u,u=[];++l<e;)c&&c[l].run();l=-1,e=u.length}c=null,h=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function g(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new p(t,e)),1!==u.length||h||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,r){"use strict";var n=r(0);t.exports=function(t,e){n.forEach(t,function(r,n){n!==e&&n.toUpperCase()===e.toUpperCase()&&(t[e]=r,delete t[n])})}},function(t,e,r){"use strict";var n=r(5);t.exports=function(t,e,r){var i=r.config.validateStatus;r.status&&i&&!i(r.status)?e(n("Request failed with status code "+r.status,r.config,null,r.request,r)):t(r)}},function(t,e,r){"use strict";t.exports=function(t,e,r,n,i){return t.config=e,r&&(t.code=r),t.request=n,t.response=i,t}},function(t,e,r){"use strict";var n=r(0);function i(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,r){if(!e)return t;var a;if(r)a=r(e);else if(n.isURLSearchParams(e))a=e.toString();else{var o=[];n.forEach(e,function(t,e){null!=t&&(n.isArray(t)?e+="[]":t=[t],n.forEach(t,function(t){n.isDate(t)?t=t.toISOString():n.isObject(t)&&(t=JSON.stringify(t)),o.push(i(e)+"="+i(t))}))}),a=o.join("&")}return a&&(t+=(-1===t.indexOf("?")?"?":"&")+a),t}},function(t,e,r){"use strict";var n=r(0),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,r,a,o={};return t?(n.forEach(t.split("\n"),function(t){if(a=t.indexOf(":"),e=n.trim(t.substr(0,a)).toLowerCase(),r=n.trim(t.substr(a+1)),e){if(o[e]&&i.indexOf(e)>=0)return;o[e]="set-cookie"===e?(o[e]?o[e]:[]).concat([r]):o[e]?o[e]+", "+r:r}}),o):o}},function(t,e,r){"use strict";var n=r(0);t.exports=n.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function i(t){var n=t;return e&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return t=i(window.location.href),function(e){var r=n.isString(e)?i(e):e;return r.protocol===t.protocol&&r.host===t.host}}():function(){return!0}},function(t,e,r){"use strict";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function i(){this.message="String contains an invalid character"}i.prototype=new Error,i.prototype.code=5,i.prototype.name="InvalidCharacterError",t.exports=function(t){for(var e,r,a=String(t),o="",s=0,c=n;a.charAt(0|s)||(c="=",s%1);o+=c.charAt(63&e>>8-s%1*8)){if((r=a.charCodeAt(s+=.75))>255)throw new i;e=e<<8|r}return o}},function(t,e,r){"use strict";var n=r(0);t.exports=n.isStandardBrowserEnv()?{write:function(t,e,r,i,a,o){var s=[];s.push(t+"="+encodeURIComponent(e)),n.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),n.isString(i)&&s.push("path="+i),n.isString(a)&&s.push("domain="+a),!0===o&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,r){"use strict";var n=r(0);function i(){this.handlers=[]}i.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},i.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},i.prototype.forEach=function(t){n.forEach(this.handlers,function(e){null!==e&&t(e)})},t.exports=i},function(t,e,r){"use strict";var n=r(0),i=r(22),a=r(6),o=r(1),s=r(23),c=r(24);function u(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return u(t),t.baseURL&&!s(t.url)&&(t.url=c(t.baseURL,t.url)),t.headers=t.headers||{},t.data=i(t.data,t.headers,t.transformRequest),t.headers=n.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),n.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]}),(t.adapter||o.adapter)(t).then(function(e){return u(t),e.data=i(e.data,e.headers,t.transformResponse),e},function(e){return a(e)||(u(t),e&&e.response&&(e.response.data=i(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},function(t,e,r){"use strict";var n=r(0);t.exports=function(t,e,r){return n.forEach(r,function(r){t=r(t,e)}),t}},function(t,e,r){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,r){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,r){"use strict";var n=r(7);function i(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(t){e=t});var r=this;t(function(t){r.reason||(r.reason=new n(t),e(r.reason))})}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var t;return{token:new i(function(e){t=e}),cancel:t}},t.exports=i},function(t,e,r){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,r){"use strict";r.r(e);var n=r(2),i=r.n(n);let a,o=new Map,s=new Map,c="http://localhost:9091";r.d(e,"default",function(){return X});let u="http://localhost:9091",h=new class{constructor(){if(a)return a;a=this,this.reset(),this.prepared=0,this.aiOver=!0,this.playerOver=!0,this.initAIState(),this.randomAITarget(),this.initPlayerState(),this.randomPlayerTarget(),this.initPolicy(),this.initTransition()}initAIState(){this.aiState<0&&(this.aiState=parseInt(100*Math.random()),this.aiLastState=this.aiState)}initPlayerState(){this.playerState<0&&(this.playerState=parseInt(100*Math.random()),this.playerLastState=this.playerState)}initPolicy(){var t=this;i.a.get(c+"/policy").then(function(e){for(var r in e.data){var n=e.data[r],i=new Map;for(var a in n)i.set(parseInt(a),parseInt(n[a]));o.set(parseInt(r),i)}t.prepared+=1}).catch(function(t){console.log(t)})}initTransition(){var t=this;i.a.get(c+"/transition").then(function(e){for(var r in e.data){var n=e.data[r];s.set(parseInt(r),n)}t.prepared+=1}).catch(function(t){console.log(t)})}isPrepared(){return this.prepared>=2}reset(){this.frame=0,this.aiState=-1,this.aiLastState=-1,this.aiAction=-1,this.aiTarget=-1,this.playerState=-1,this.playerLastState=-1,this.playerAction=-1,this.playerTarget=-1,this.playerLastAction=this.playerAction,this.playerLastTouchTime=0,this.playerShouldStop=!1,this.playerPoint=0,this.aiPoint=0,this.gameOver=!1,this.rate=.5,this.lastRate=0}getPlayerPoint(){return this.playerPoint>9?this.playerPoint:"0"+this.playerPoint}getAIPoint(){return this.aiPoint>9?this.aiPoint:"0"+this.aiPoint}randomAITarget(){for(this.aiLastTarget=this.aiTarget;;){var t=parseInt(100*Math.random());if(t!=this.playerTarget&&t!=this.aiState&&t!=this.playerState){this.aiTarget=t;break}}}getPointRate(){return this.rate}calculateRate(){if(this.aiPoint>this.playerPoint){var t=this.aiPoint-this.playerPoint;this.rate=(50+t)/100}else this.aiPoint<this.playerPoint&&(t=this.playerPoint-this.aiPoint,this.rate=(50-t)/100)}shouldDrawPoint(){return this.lastRate!=this.rate}resetLastRate(){this.lastRate=this.rate}checkGameOver(){return(this.aiPoint>=50||this.playerPoint>=50)&&(this.gameOver=!0),this.gameOver=!1,this.gameOver}randomPlayerTarget(){for(this.playerLastTarget=this.playerTarget;;){var t=parseInt(100*Math.random());if(t!=this.aiTarget&&t!=this.playerState&&t!=this.aiState){this.playerTarget=t;break}}}nextAIState(){return this.aiAction=this.getAction(this.aiState,this.aiTarget),this.aiLastState=this.aiState,this.aiState=this.getState(this.aiState,this.aiAction),this.aiState}nextPlayerState(){return-1==this.playerAction?this.playerState:(this.playerLastState=this.playerState,this.playerState=this.getState(this.playerState,this.playerAction),this.playerState)}setPlayerAction(t){this.playerLastAction=this.playerAction,this.playerAction=t}isAIOver(){return this.aiOver=this.aiState==this.aiTarget,this.aiOver&&(this.aiPoint+=1,this.calculateRate()),this.aiOver}isPlayerOver(){return this.playerOver=this.playerState==this.playerTarget,this.playerOver&&(this.playerPoint+=1,this.calculateRate()),this.playerOver}getAction(t,e){return o.get(e).get(t)}getState(t,e){return s.get(t)[e]}};const l=36,f=6,d=l+f,p=10*l+11*f;let g=parseInt(window.innerHeight/4),m=(window.innerWidth-p)/2,y=20,w=5,v=document.createElement("canvas");v.width=p,v.height=p;let T=v.getContext("2d");v.style.position="fixed",v.style.left=m+"px",v.style.top=g+"px",document.body.appendChild(v);var S=document.createElement("canvas");S.width=window.innerWidth,S.height=window.innerHeight;var x=S.getContext("2d"),A=parseInt(window.innerWidth/5),P=parseInt(window.innerHeight/24),L=document.createElement("canvas");L.width=A,L.height=P;var b=L.getContext("2d"),I=2*L.width,R=parseInt(window.innerHeight/6);L.style.position="fixed",L.style.top=R+"px",L.style.left=I+"px",document.body.appendChild(L);var E=document.createElement("canvas"),C=E.getContext("2d");E.width=A,E.height=P;var O=document.createElement("canvas");O.width=p,O.height=p;var j=O.getContext("2d"),_=new Image;_.src=u+"/static/images/bean_ai.png";var k=new Image;k.src=u+"/static/images/bean_player.png";var B=new Image;B.src=u+"/static/images/eater_ai_up.png";var q=new Image;q.src=u+"/static/images/eater_ai_right.png";var U=new Image;U.src=u+"/static/images/eater_ai_down.png";var D=new Image;D.src=u+"/static/images/eater_ai_left.png";var N=new Image;N.src=u+"/static/images/eater_player_up.png";var H=new Image;H.src=u+"/static/images/eater_player_right.png";var F=new Image;F.src=u+"/static/images/eater_player_down.png";var M=new Image;M.src=u+"/static/images/eater_player_left.png";class X{constructor(){this.aniId=0,this.initTouchEvent(),this.initLabyrinth(),this.restart()}restart(){v.removeEventListener("touchstart",this.touchHandler),this.bindLoop=this.loop.bind(this),window.cancelAnimationFrame(this.aniId),this.aniId=window.requestAnimationFrame(this.bindLoop,v)}initTouchEvent(){document.onkeydown=function(){var t=window.event;87==t.keyCode?h.setPlayerAction(0):68==t.keyCode?h.setPlayerAction(1):83==t.keyCode?h.setPlayerAction(2):65==t.keyCode?h.setPlayerAction(3):32==t.keyCode&&h.setPlayerAction(-1)}}initLabyrinth(){x.lineWidth=f/2,this.setBackground(),this.drawBorder(),this.drawLabyrinth()}drawLine(t){var e=t[0],r=e[0]*d;10==e[0]&&(r+=f);var n=e[1]*d;10==e[1]&&(n+=f),x.moveTo(r,n);for(var i=1;i<t.length;i++){r=t[i][0]*d;10==t[i][0]&&(r+=f);n=t[i][1]*d;10==t[i][1]&&(n+=f),x.lineTo(r,n)}}drawLabyrinth(){this.drawLine([[5,0],[5,1],[4,1],[4,3]]),this.drawLine([[0,1],[2,1],[2,2],[3,2],[3,1]]),this.drawLine([[7,1],[10,1]]),this.drawLine([[6,1],[6,3]]),this.drawLine([[5,2],[9,2],[9,6]]),this.drawLine([[1,2],[1,3],[5,3]]),this.drawLine([[8,3],[7,3],[7,8]]),this.drawLine([[3,3],[3,5]]),this.drawLine([[3,4],[5,4]]),this.drawLine([[0,4],[2,4],[2,5],[1,5]]),this.drawLine([[8,4],[6,4],[6,5],[4,5],[4,7]]),this.drawLine([[9,5],[8,5],[8,7],[10,7]]),this.drawLine([[1,6],[4,6]]),this.drawLine([[2,6],[2,9]]),this.drawLine([[0,7],[1,7]]),this.drawLine([[1,8],[1,10]]),this.drawLine([[3,7],[3,10]]),this.drawLine([[3,8],[5,8],[5,6]]),this.drawLine([[4,9],[6,9],[6,8],[8,8],[8,9],[9,9],[9,8]]),this.drawLine([[5,9],[5,10]]),this.drawLine([[7,9],[7,10]]),x.stroke()}drawBorder(){x.strokeStyle="black",x.strokeRect(0,0,p,p)}setBackground(){x.fillStyle="white",x.fillRect(0,0,S.width,S.height)}touchEventHandler(t){t.preventDefault()}clearAITarget(){var t=h.aiTarget%10,e=parseInt(h.aiTarget/10),r=(t+1)*f+t*l,n=(e+1)*f+e*l;j.clearRect(r,n,20,20)}clearPlayerTarget(){var t=h.playerTarget%10,e=parseInt(h.playerTarget/10),r=(t+1)*f+t*l,n=(e+1)*f+e*l;j.clearRect(r,n,20,20)}drawAITarget(){var t=h.aiTarget,e=t%10,r=parseInt(t/10),n=(e+1)*f+e*l,i=(r+1)*f+r*l;j.drawImage(_,n,i),T.drawImage(O,0,0)}drawPlayerTarget(){var t=h.playerTarget,e=t%10,r=parseInt(t/10),n=(e+1)*f+e*l,i=(r+1)*f+r*l;j.drawImage(k,n,i),T.drawImage(O,0,0)}drawTarget(){h.aiLastTarget!=h.aiTarget&&this.clearAITarget(),this.drawAITarget(),h.playerLastTarget!=h.playerTarget&&this.clearPlayerTarget(),this.drawPlayerTarget()}drawAI(){var t=h.aiState,e=t%10,r=parseInt(t/10),n=(e+1)*f+e*l,i=(r+1)*f+r*l;0===h.aiAction?j.drawImage(B,n,i):1===h.aiAction?j.drawImage(q,n,i):2===h.aiAction?j.drawImage(U,n,i):j.drawImage(D,n,i),T.drawImage(O,0,0)}drawPlayer(){var t=-1;t=-1==h.playerAction?h.playerLastAction:h.playerAction;var e=h.playerState,r=e%10,n=parseInt(e/10),i=(r+1)*f+r*l,a=(n+1)*f+n*l;0===t?j.drawImage(N,i,a):1===t?j.drawImage(H,i,a):2===t?j.drawImage(F,i,a):j.drawImage(M,i,a),T.drawImage(O,0,0)}drawPoint(){if(b.clearRect(0,0,L.width,L.height),h.shouldDrawPoint()){C.clearRect(0,0,E.width,E.height);var t=h.getPointRate(),e=A*(t-.05),r=A*(t+.05),n=b.createLinearGradient(e,0,r,0);n.addColorStop(0,"red"),n.addColorStop(1,"blue"),C.fillStyle=n,C.fillRect(0,0,A,P),h.resetLastRate()}b.drawImage(E,0,0)}clearAll(){T.clearRect(0,0,v.width,v.height),j.clearRect(0,0,O.width,O.height)}doRender(){this.clearAll(),T.drawImage(S,0,0),this.drawAI(),this.drawPlayer(),this.drawTarget(),this.drawPoint()}render(){this.doRender(),h.gameOver&&(this.hasEventBind||(this.hasEventBind=!0,this.touchHandler=this.touchEventHandler.bind(this),v.addEventListener("touchstart",this.touchHandler)))}update(){h.checkGameOver(),h.gameOver||(h.nextAIState(),h.nextPlayerState(),h.isAIOver()&&h.randomAITarget(),h.isPlayerOver()&&h.randomPlayerTarget())}loop(){h.frame+=1,h.isPrepared()&&(h.frame%y==0&&this.update(),h.frame%w==0&&this.render()),this.aniId=window.requestAnimationFrame(this.bindLoop,v)}}new X}]);